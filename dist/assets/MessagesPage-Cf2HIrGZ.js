import{c as _,f as H,r as i,j as s,B as P}from"./index-BdCLm_2q.js";import{t as d,F as $,D as z,a as q,b as G,C as X}from"./ConfirmDialog-Cg1O1OVZ.js";import{v as Y,w as J,h as K,M as t,A as Q,i as W,x as Z}from"./LoadingSkeleton-Bjl2B8jF.js";import{S as ee}from"./StatusBadge-DL9Kg-YL.js";import{E as se}from"./eye-BGcKiBtJ.js";import{C as ae}from"./circle-check-big-CeSEhlNP.js";import{T as w}from"./trash-2-DOJjAdpj.js";import{S as te}from"./send-DPosts2F.js";import"./tslib.es6-ywRZ5Esg.js";import"./input-CJTBT2o9.js";import"./parseISO--f4aoRI6.js";import"./index-p6lGUO2k.js";import"./index-C-e6FMg7.js";import"./index-DB36gIdi.js";import"./skeleton-BRfOg84M.js";import"./search-D_d7FJv8.js";import"./chevron-right-Dxt0Ltpk.js";import"./select-BnlIWH-n.js";import"./index-2gvreq7C.js";import"./check-D6d9sIwu.js";import"./badge-DyNZl9wy.js";import"./funnel-DdenPZov.js";import"./calendar-BtdhrUPo.js";import"./separator-CgEPudON.js";import"./scroll-area-lJ7RbBUr.js";import"./phone-Bl3CEY2N.js";import"./mail-DFPmZ15m.js";import"./loader-circle-CkulKoGi.js";import"./users-DZKOeETJ.js";import"./building-2-CR-r7spi.js";import"./message-square-BKrPQKGn.js";import"./shield-Bd7IaV_q.js";import"./bell-zZ1kEipe.js";const re=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],D=_("archive",re);const ce=[["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}],["path",{d:"m9 17-5-5 5-5",key:"nvlc11"}]],E=_("reply",ce),ie=[{key:"search",label:"Search",type:"search"},{key:"status",label:"Status",type:"select",options:Object.entries(Z).map(([p,m])=>({value:p,label:m}))}];function Be(){const[p,m]=H(),[x,k]=i.useState(null),[A,g]=i.useState(null),[y,b]=i.useState(""),[I,o]=i.useState(!1),[u,v]=i.useState({status:p.get("status")||"",search:p.get("search")||""}),[F,M]=i.useState({page:1,perPage:10}),{data:n,isLoading:L,error:C,refresh:c}=Y({filters:{status:u.status||void 0,search:u.search||void 0},pagination:F,autoRefresh:!0}),{data:a,updateStatus:l}=J(x),f=async e=>{k(e);const r=n.data.find(h=>h.id===e);r&&r.status===t.UNREAD&&(await l(t.READ),c())},T=i.useMemo(()=>[{key:"sender_name",header:"From",sortable:!0,render:e=>s.jsxs("div",{"code-path":"src/admin/pages/MessagesPage.tsx:111:9",className:"flex items-center gap-3",children:[s.jsx("div",{"code-path":"src/admin/pages/MessagesPage.tsx:112:11",className:`
            w-8 h-8 rounded-full flex items-center justify-center text-xs font-medium
            ${e.status===t.UNREAD?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"}
          `,children:e.sender_name.split(" ").map(r=>r[0]).join("").slice(0,2).toUpperCase()}),s.jsxs("div",{"code-path":"src/admin/pages/MessagesPage.tsx:120:11",children:[s.jsx("p",{"code-path":"src/admin/pages/MessagesPage.tsx:121:13",className:`font-medium ${e.status===t.UNREAD?"text-foreground":""}`,children:e.sender_name}),s.jsx("p",{"code-path":"src/admin/pages/MessagesPage.tsx:124:13",className:"text-xs text-muted-foreground",children:e.sender_email})]})]})},{key:"subject",header:"Subject",sortable:!0,render:e=>s.jsxs("div",{"code-path":"src/admin/pages/MessagesPage.tsx:134:9",children:[s.jsx("p",{"code-path":"src/admin/pages/MessagesPage.tsx:135:11",className:`truncate max-w-[250px] ${e.status===t.UNREAD?"font-semibold":""}`,children:e.subject||"(No Subject)"}),s.jsxs("p",{"code-path":"src/admin/pages/MessagesPage.tsx:138:11",className:"text-xs text-muted-foreground truncate max-w-[250px]",children:[e.message.substring(0,60),e.message.length>60?"...":""]})]})},{key:"status",header:"Status",sortable:!0,render:e=>s.jsx(ee,{"code-path":"src/admin/pages/MessagesPage.tsx:148:24",status:e.status,type:"message"})},{key:"created_at",header:"Received",sortable:!0,render:e=>K(e.created_at)}],[]),U=i.useMemo(()=>[{label:"View",icon:s.jsx(se,{"code-path":"src/admin/pages/MessagesPage.tsx:162:13",className:"w-4 h-4"}),onClick:e=>f(e.id)},{label:"Mark as Read",icon:s.jsx(ae,{"code-path":"src/admin/pages/MessagesPage.tsx:167:13",className:"w-4 h-4"}),onClick:async e=>{(await l(t.READ)).success&&(d.success("Marked as read"),c())},disabled:e=>e.status!==t.UNREAD},{label:"Reply",icon:s.jsx(E,{"code-path":"src/admin/pages/MessagesPage.tsx:179:13",className:"w-4 h-4"}),onClick:e=>{f(e.id),o(!0)}},{label:"Archive",icon:s.jsx(D,{"code-path":"src/admin/pages/MessagesPage.tsx:187:13",className:"w-4 h-4"}),onClick:async e=>{(await l(t.ARCHIVED)).success&&(d.success("Message archived"),c())},disabled:e=>e.status===t.ARCHIVED},{label:"Delete",icon:s.jsx(w,{"code-path":"src/admin/pages/MessagesPage.tsx:199:13",className:"w-4 h-4"}),onClick:e=>g(e.id),variant:"destructive"}],[n.data,c,l]),V=(e,r)=>{const h={...u,[e]:r};v(h),M(j=>({...j,page:1}));const N=new URLSearchParams;Object.entries(h).forEach(([j,S])=>{S&&N.set(j,S)}),m(N)},R=()=>{v({status:"",search:""}),M(e=>({...e,page:1})),m(new URLSearchParams)},B=async()=>{if(!a||!y.trim())return;(await l(t.REPLIED)).success&&(d.success("Reply sent"),b(""),o(!1),c())},O=a?[{key:"sender_name",label:"From",type:"text",value:a.sender_name},{key:"sender_email",label:"Email",type:"email",value:a.sender_email},{key:"sender_phone",label:"Phone",type:"phone",value:a.sender_phone},{key:"subject",label:"Subject",type:"text",value:a.subject},{key:"message",label:"Message",type:"text",value:a.message},{key:"created_at",label:"Received",type:"date",value:a.created_at},{key:"replied_at",label:"Replied",type:"date",value:a.replied_at}]:[];return s.jsxs(Q,{"code-path":"src/admin/pages/MessagesPage.tsx:252:5",title:"Messages",subtitle:"Manage contact form submissions and inquiries",children:[C&&s.jsxs("div",{"code-path":"src/admin/pages/MessagesPage.tsx:258:9",className:"mb-4 p-4 rounded-lg bg-red-50 text-red-600 text-sm",children:[C,s.jsx(P,{"code-path":"src/admin/pages/MessagesPage.tsx:260:11",variant:"link",onClick:c,className:"ml-2",children:"Retry"})]}),s.jsx($,{"code-path":"src/admin/pages/MessagesPage.tsx:267:7",filters:ie,values:u,onChange:V,onClear:R,className:"mb-6"}),L?s.jsx(W,{"code-path":"src/admin/pages/MessagesPage.tsx:277:9",columns:4,rows:5}):s.jsx(z,{"code-path":"src/admin/pages/MessagesPage.tsx:279:9",data:n.data,columns:T,keyExtractor:e=>e.id,actions:U,pagination:{page:n.page,perPage:n.perPage,total:n.count,onPageChange:e=>M(r=>({...r,page:e}))},onRowClick:e=>f(e.id),emptyState:{title:"No messages found",description:"Your inbox is empty.",icon:s.jsx(q,{"code-path":"src/admin/pages/MessagesPage.tsx:294:19",className:"w-10 h-10 text-muted-foreground/50"}),action:{label:"Clear Filters",onClick:R}}}),s.jsx(G,{"code-path":"src/admin/pages/MessagesPage.tsx:304:7",isOpen:!!x,onClose:()=>{k(null),o(!1),b("")},title:a?.subject||"Message Details",subtitle:a?.sender_name,status:a?{value:a.status,type:"message"}:void 0,fields:O,actions:{primary:a?.status!==t.REPLIED?{label:"Reply",icon:s.jsx(E,{"code-path":"src/admin/pages/MessagesPage.tsx:318:19",className:"w-4 h-4"}),onClick:()=>o(!0)}:void 0,secondary:[...a?.status!==t.ARCHIVED?[{label:"Archive",icon:s.jsx(D,{"code-path":"src/admin/pages/MessagesPage.tsx:324:21",className:"w-4 h-4"}),onClick:async()=>{(a?await l(t.ARCHIVED):{success:!1}).success&&(d.success("Message archived"),c())}}]:[],{label:"Delete",icon:s.jsx(w,{"code-path":"src/admin/pages/MessagesPage.tsx:335:21",className:"w-4 h-4"}),onClick:()=>g(x)}]},children:I&&s.jsxs("div",{"code-path":"src/admin/pages/MessagesPage.tsx:343:11",className:"space-y-3 pt-4 border-t",children:[s.jsx("label",{"code-path":"src/admin/pages/MessagesPage.tsx:344:13",className:"text-sm font-medium",children:"Reply"}),s.jsx("textarea",{"code-path":"src/admin/pages/MessagesPage.tsx:345:13",value:y,onChange:e=>b(e.target.value),placeholder:"Type your reply...",className:"w-full min-h-[100px] p-3 rounded-md border border-input bg-background text-sm"}),s.jsxs("div",{"code-path":"src/admin/pages/MessagesPage.tsx:351:13",className:"flex justify-end gap-2",children:[s.jsx(P,{"code-path":"src/admin/pages/MessagesPage.tsx:352:15",variant:"outline",size:"sm",onClick:()=>o(!1),children:"Cancel"}),s.jsxs(P,{"code-path":"src/admin/pages/MessagesPage.tsx:355:15",size:"sm",onClick:B,disabled:!y.trim(),children:[s.jsx(te,{"code-path":"src/admin/pages/MessagesPage.tsx:356:17",className:"w-4 h-4 mr-2"}),"Send Reply"]})]})]})}),s.jsx(X,{"code-path":"src/admin/pages/MessagesPage.tsx:365:7",isOpen:!!A,onClose:()=>g(null),onConfirm:()=>{g(null),d.success("Message deleted"),c()},title:"Delete Message",description:"Are you sure you want to delete this message? This action cannot be undone.",confirmLabel:"Delete",variant:"danger"})]})}export{Be as default};
