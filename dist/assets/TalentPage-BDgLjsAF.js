import{u as H,f as q,r as c,j as a,B as j}from"./index-BdCLm_2q.js";import{B as J}from"./badge-DyNZl9wy.js";import{t as r,F as X,D as $,a as W,b as z,C as G}from"./ConfirmDialog-Cg1O1OVZ.js";import{s as F,g as K,d as Q,e as Y,h as Z,T as p,A as ee,i as ae,j as te}from"./LoadingSkeleton-Bjl2B8jF.js";import{S as se}from"./StatusBadge-DL9Kg-YL.js";import{F as le}from"./file-text-kX29OBZ9.js";import{E as re}from"./eye-BGcKiBtJ.js";import{D}from"./download-7333vHOK.js";import{C as S}from"./circle-check-big-CeSEhlNP.js";import{C as ne}from"./circle-x-C_zPDZYB.js";import{T as N}from"./trash-2-DOJjAdpj.js";import{P as ie}from"./plus-BcHjMXQU.js";import"./tslib.es6-ywRZ5Esg.js";import"./input-CJTBT2o9.js";import"./parseISO--f4aoRI6.js";import"./index-p6lGUO2k.js";import"./index-C-e6FMg7.js";import"./index-DB36gIdi.js";import"./skeleton-BRfOg84M.js";import"./search-D_d7FJv8.js";import"./chevron-right-Dxt0Ltpk.js";import"./select-BnlIWH-n.js";import"./index-2gvreq7C.js";import"./check-D6d9sIwu.js";import"./funnel-DdenPZov.js";import"./calendar-BtdhrUPo.js";import"./separator-CgEPudON.js";import"./scroll-area-lJ7RbBUr.js";import"./phone-Bl3CEY2N.js";import"./mail-DFPmZ15m.js";import"./loader-circle-CkulKoGi.js";import"./users-DZKOeETJ.js";import"./building-2-CR-r7spi.js";import"./message-square-BKrPQKGn.js";import"./shield-Bd7IaV_q.js";import"./bell-zZ1kEipe.js";async function oe(o){try{const{data:s,error:d}=await F.from("files").select("*").eq("id",o).single();if(d||!s)return null;const n=s;return n.public_url?n.public_url:await K(n.path,n.bucket)}catch(s){return console.error("Error getting file download URL:",s),null}}async function E(o){try{const{data:s,error:d}=await F.from("talent_profiles").select("cv_file_id").eq("id",o).single();return d||!s?.cv_file_id?null:await oe(s.cv_file_id)}catch(s){return console.error("Error getting CV URL:",s),null}}const ce=[{key:"search",label:"Search",type:"search"},{key:"status",label:"Status",type:"select",options:Object.entries(te).map(([o,s])=>({value:o,label:s}))},{key:"industry",label:"Industry",type:"select",options:[{value:"Technology",label:"Technology"},{value:"Finance",label:"Finance"},{value:"Healthcare",label:"Healthcare"},{value:"Education",label:"Education"},{value:"Marketing",label:"Marketing"}]},{key:"role_category",label:"Role Category",type:"select",options:[{value:"Engineering",label:"Engineering"},{value:"Product",label:"Product"},{value:"Design",label:"Design"},{value:"Marketing",label:"Marketing"},{value:"Sales",label:"Sales"}]},{key:"date_from",label:"From",type:"date"},{key:"date_to",label:"To",type:"date"}];function $e(){const o=H(),[s,d]=q(),[n,y]=c.useState(null),[T,m]=c.useState(null),[R,g]=c.useState(!1),[i,v]=c.useState({status:s.get("status")||"",search:s.get("search")||"",industry:"",role_category:"",date_from:"",date_to:""}),[L,f]=c.useState({page:1,perPage:10}),{data:h,isLoading:V,error:_,refresh:u}=Q({filters:{status:i.status||void 0,search:i.search||void 0,industry:i.industry||void 0,role_category:i.role_category||void 0,date_from:i.date_from||void 0,date_to:i.date_to||void 0},pagination:L,autoRefresh:!0}),{data:t,updateStatus:x,remove:A}=Y(n),I=c.useMemo(()=>[{key:"full_name",header:"Name",sortable:!0,render:e=>a.jsxs("div",{"code-path":"src/admin/pages/TalentPage.tsx:145:9",className:"flex items-center gap-3",children:[a.jsx("div",{"code-path":"src/admin/pages/TalentPage.tsx:146:11",className:"w-8 h-8 rounded-full bg-gradient-to-br from-rose-500 to-orange-500 flex items-center justify-center text-white text-xs font-medium",children:e.full_name.split(" ").map(l=>l[0]).join("").slice(0,2).toUpperCase()}),a.jsxs("div",{"code-path":"src/admin/pages/TalentPage.tsx:149:11",children:[a.jsx("p",{"code-path":"src/admin/pages/TalentPage.tsx:150:13",className:"font-medium",children:e.full_name}),a.jsx("p",{"code-path":"src/admin/pages/TalentPage.tsx:151:13",className:"text-xs text-muted-foreground",children:e.email})]})]})},{key:"headline",header:"Headline",sortable:!0,render:e=>a.jsx("span",{"code-path":"src/admin/pages/TalentPage.tsx:161:9",className:"text-sm text-muted-foreground truncate max-w-[200px] block",children:e.headline||"-"})},{key:"industry",header:"Industry",sortable:!0,render:e=>e.industry||"-"},{key:"status",header:"Status",sortable:!0,render:e=>a.jsx(se,{"code-path":"src/admin/pages/TalentPage.tsx:176:24",status:e.status,type:"talent"})},{key:"cv_file_id",header:"CV",align:"center",render:e=>e.cv_file_id?a.jsxs(J,{"code-path":"src/admin/pages/TalentPage.tsx:183:9",variant:"outline",className:"gap-1",children:[a.jsx(le,{"code-path":"src/admin/pages/TalentPage.tsx:184:11",className:"w-3 h-3"}),"Attached"]}):a.jsx("span",{"code-path":"src/admin/pages/TalentPage.tsx:188:9",className:"text-muted-foreground text-sm",children:"-"})},{key:"created_at",header:"Submitted",sortable:!0,render:e=>Z(e.created_at)}],[]),O=c.useMemo(()=>[{label:"View Details",icon:a.jsx(re,{"code-path":"src/admin/pages/TalentPage.tsx:203:13",className:"w-4 h-4"}),onClick:e=>y(e.id)},{label:"Download CV",icon:a.jsx(D,{"code-path":"src/admin/pages/TalentPage.tsx:208:13",className:"w-4 h-4"}),onClick:async e=>{if(!e.cv_file_id){r.error("No CV attached");return}g(!0);try{const l=await E(e.id);l?(window.open(l,"_blank"),r.success("CV download started")):r.error("Failed to get CV URL")}finally{g(!1)}},disabled:e=>!e.cv_file_id},{label:"Approve",icon:a.jsx(S,{"code-path":"src/admin/pages/TalentPage.tsx:231:13",className:"w-4 h-4"}),onClick:async e=>{(await x(p.APPROVED)).success?(r.success("Talent approved"),u()):r.error("Failed to approve talent")},disabled:e=>e.status===p.APPROVED},{label:"Reject",icon:a.jsx(ne,{"code-path":"src/admin/pages/TalentPage.tsx:245:13",className:"w-4 h-4"}),onClick:async e=>{(await x(p.REJECTED)).success?(r.success("Talent rejected"),u()):r.error("Failed to reject talent")},disabled:e=>e.status===p.REJECTED,variant:"destructive"},{label:"Delete",icon:a.jsx(N,{"code-path":"src/admin/pages/TalentPage.tsx:260:13",className:"w-4 h-4"}),onClick:e=>m(e.id),variant:"destructive"}],[u]),U=(e,l)=>{const P={...i,[e]:l};v(P),f(b=>({...b,page:1}));const w=new URLSearchParams;Object.entries(P).forEach(([b,C])=>{C&&w.set(b,C)}),d(w)},k=()=>{v({status:"",search:"",industry:"",role_category:"",date_from:"",date_to:""}),f(e=>({...e,page:1})),d(new URLSearchParams)},B=async()=>{if(!T)return;(await A()).success?(r.success("Talent deleted successfully"),u()):r.error("Failed to delete talent"),m(null)},M=t?[{key:"full_name",label:"Full Name",type:"text",value:t.full_name},{key:"email",label:"Email",type:"email",value:t.email},{key:"phone",label:"Phone",type:"phone",value:t.phone},{key:"headline",label:"Headline",type:"text",value:t.headline},{key:"industry",label:"Industry",type:"badge",value:t.industry},{key:"role_category",label:"Role Category",type:"badge",value:t.role_category},{key:"years_of_experience",label:"Experience",type:"text",value:t.years_of_experience},{key:"country",label:"Location",type:"text",value:`${t.city||""}, ${t.country||""}`.trim()},{key:"skills",label:"Skills",type:"list",value:t.skills},{key:"linkedin_url",label:"LinkedIn",type:"link",value:t.linkedin_url},{key:"website_url",label:"Website",type:"link",value:t.website_url},{key:"bio",label:"Bio",type:"text",value:t.bio},{key:"created_at",label:"Submitted",type:"date",value:t.created_at}]:[];return a.jsxs(ee,{"code-path":"src/admin/pages/TalentPage.tsx:324:5",title:"Talent Profiles",subtitle:"Manage talent submissions and approvals",actions:a.jsxs(j,{"code-path":"src/admin/pages/TalentPage.tsx:328:9",onClick:()=>o("/admin/talent/new"),children:[a.jsx(ie,{"code-path":"src/admin/pages/TalentPage.tsx:329:11",className:"w-4 h-4 mr-2"}),"Add Talent"]}),children:[_&&a.jsxs("div",{"code-path":"src/admin/pages/TalentPage.tsx:336:9",className:"mb-4 p-4 rounded-lg bg-red-50 text-red-600 text-sm",children:[_,a.jsx(j,{"code-path":"src/admin/pages/TalentPage.tsx:338:11",variant:"link",onClick:u,className:"ml-2",children:"Retry"})]}),a.jsx(X,{"code-path":"src/admin/pages/TalentPage.tsx:345:7",filters:ce,values:i,onChange:U,onClear:k,className:"mb-6"}),V?a.jsx(ae,{"code-path":"src/admin/pages/TalentPage.tsx:355:9",columns:6,rows:5}):a.jsx($,{"code-path":"src/admin/pages/TalentPage.tsx:357:9",data:h.data,columns:I,keyExtractor:e=>e.id,actions:O,pagination:{page:h.page,perPage:h.perPage,total:h.count,onPageChange:e=>f(l=>({...l,page:e}))},onRowClick:e=>y(e.id),emptyState:{title:"No talent found",description:"Try adjusting your filters or add new talent.",icon:a.jsx(W,{"code-path":"src/admin/pages/TalentPage.tsx:372:19",className:"w-10 h-10 text-muted-foreground/50"}),action:{label:"Clear Filters",onClick:k}}}),a.jsx(z,{"code-path":"src/admin/pages/TalentPage.tsx:382:7",isOpen:!!n,onClose:()=>y(null),title:t?.full_name||"Talent Details",subtitle:t?.headline||void 0,status:t?{value:t.status,type:"talent"}:void 0,fields:M,actions:{primary:t?.status!==p.APPROVED?{label:"Approve",icon:a.jsx(S,{"code-path":"src/admin/pages/TalentPage.tsx:392:19",className:"w-4 h-4"}),onClick:async()=>{(await x(p.APPROVED)).success&&(r.success("Talent approved"),u())}}:void 0,secondary:[...t?.cv_file_id?[{label:R?"Downloading...":"Download CV",icon:a.jsx(D,{"code-path":"src/admin/pages/TalentPage.tsx:404:21",className:"w-4 h-4"}),onClick:async()=>{g(!0);try{const e=await E(t.id);e&&window.open(e,"_blank")}finally{g(!1)}}}]:[],{label:"Delete",icon:a.jsx(N,{"code-path":"src/admin/pages/TalentPage.tsx:417:21",className:"w-4 h-4"}),onClick:()=>m(n)}]}}),a.jsx(G,{"code-path":"src/admin/pages/TalentPage.tsx:425:7",isOpen:!!T,onClose:()=>m(null),onConfirm:B,title:"Delete Talent",description:"Are you sure you want to delete this talent profile? This action cannot be undone.",confirmLabel:"Delete",variant:"danger"})]})}export{$e as default};
