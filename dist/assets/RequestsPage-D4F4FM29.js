import{f as F,r as u,j as s,B}from"./index-BdCLm_2q.js";import{B as v}from"./badge-DyNZl9wy.js";import{t as i,F as U,D as I,a as M,b as V,C as G}from"./ConfirmDialog-Cg1O1OVZ.js";import{o as H,p as Q,h as X,R as a,A as z,i as W,q as y,r as Y,t as J}from"./LoadingSkeleton-Bjl2B8jF.js";import{S as K}from"./StatusBadge-DL9Kg-YL.js";import{U as Z}from"./user-BZz14fkm.js";import{B as $}from"./building-2-CR-r7spi.js";import{C as ee}from"./circle-alert-Blid6a1F.js";import{E as se}from"./eye-BGcKiBtJ.js";import{C as S}from"./circle-check-big-CeSEhlNP.js";import{C as j}from"./circle-x-C_zPDZYB.js";import{T as _}from"./trash-2-DOJjAdpj.js";import"./tslib.es6-ywRZ5Esg.js";import"./input-CJTBT2o9.js";import"./parseISO--f4aoRI6.js";import"./index-p6lGUO2k.js";import"./index-C-e6FMg7.js";import"./index-DB36gIdi.js";import"./skeleton-BRfOg84M.js";import"./search-D_d7FJv8.js";import"./chevron-right-Dxt0Ltpk.js";import"./select-BnlIWH-n.js";import"./index-2gvreq7C.js";import"./check-D6d9sIwu.js";import"./funnel-DdenPZov.js";import"./calendar-BtdhrUPo.js";import"./separator-CgEPudON.js";import"./scroll-area-lJ7RbBUr.js";import"./phone-Bl3CEY2N.js";import"./mail-DFPmZ15m.js";import"./loader-circle-CkulKoGi.js";import"./users-DZKOeETJ.js";import"./message-square-BKrPQKGn.js";import"./shield-Bd7IaV_q.js";import"./bell-zZ1kEipe.js";const te=[{key:"search",label:"Search",type:"search"},{key:"status",label:"Status",type:"select",options:Object.entries(Y).map(([l,n])=>({value:l,label:n}))},{key:"priority",label:"Priority",type:"select",options:Object.entries(J).map(([l,n])=>({value:l,label:n}))},{key:"request_type",label:"Type",type:"select",options:[{value:"recommendation",label:"Recommendation"},{value:"sponsorship_intro",label:"Sponsorship Intro"},{value:"talent_match",label:"Talent Match"},{value:"general",label:"General"}]}];function Be(){const[l,n]=F(),[q,R]=u.useState(null),[w,m]=u.useState(null),[c,P]=u.useState({status:l.get("status")||"",search:l.get("search")||"",priority:"",request_type:""}),[N,b]=u.useState({page:1,perPage:10}),{data:g,isLoading:D,error:f,refresh:o}=H({filters:{status:c.status||void 0,search:c.search||void 0,priority:c.priority||void 0,request_type:c.request_type||void 0},pagination:N,autoRefresh:!1}),{data:t,updateStatus:h}=Q(q),E=e=>{switch(e){case y.URGENT:return"bg-red-100 text-red-700 border-red-200";case y.HIGH:return"bg-orange-100 text-orange-700 border-orange-200";case y.NORMAL:return"bg-blue-100 text-blue-700 border-blue-200";case y.LOW:return"bg-gray-100 text-gray-700 border-gray-200";default:return"bg-gray-100 text-gray-700"}},O=u.useMemo(()=>[{key:"request_type",header:"Type",sortable:!0,render:e=>s.jsx(v,{"code-path":"src/admin/pages/RequestsPage.tsx:139:9",variant:"outline",className:"capitalize",children:e.request_type.replace("_"," ")})},{key:"requester",header:"Requester",sortable:!0,render:e=>{const r=e.talent,p=e.sponsor,x=r?.full_name||p?.full_name||"Unknown",d=r?"Talent":p?"Sponsor":"Unknown";return s.jsxs("div",{"code-path":"src/admin/pages/RequestsPage.tsx:155:11",className:"flex items-center gap-2",children:[r?s.jsx(Z,{"code-path":"src/admin/pages/RequestsPage.tsx:157:15",className:"w-4 h-4 text-blue-500"}):p?s.jsx($,{"code-path":"src/admin/pages/RequestsPage.tsx:159:15",className:"w-4 h-4 text-green-500"}):s.jsx(ee,{"code-path":"src/admin/pages/RequestsPage.tsx:161:15",className:"w-4 h-4 text-gray-400"}),s.jsxs("div",{"code-path":"src/admin/pages/RequestsPage.tsx:163:13",children:[s.jsx("p",{"code-path":"src/admin/pages/RequestsPage.tsx:164:15",className:"font-medium",children:x}),s.jsx("p",{"code-path":"src/admin/pages/RequestsPage.tsx:165:15",className:"text-xs text-muted-foreground",children:d})]})]})}},{key:"description",header:"Description",render:e=>s.jsx("span",{"code-path":"src/admin/pages/RequestsPage.tsx:175:9",className:"text-sm text-muted-foreground truncate max-w-[250px] block",children:e.description})},{key:"priority",header:"Priority",sortable:!0,render:e=>s.jsx(v,{"code-path":"src/admin/pages/RequestsPage.tsx:185:9",variant:"outline",className:E(e.priority||""),children:e.priority||"Normal"})},{key:"status",header:"Status",sortable:!0,render:e=>s.jsx(K,{"code-path":"src/admin/pages/RequestsPage.tsx:194:24",status:e.status,type:"request"})},{key:"created_at",header:"Submitted",sortable:!0,render:e=>X(e.created_at)}],[]),L=u.useMemo(()=>[{label:"View Details",icon:s.jsx(se,{"code-path":"src/admin/pages/RequestsPage.tsx:208:13",className:"w-4 h-4"}),onClick:e=>R(e.id)},{label:"Approve",icon:s.jsx(S,{"code-path":"src/admin/pages/RequestsPage.tsx:213:13",className:"w-4 h-4"}),onClick:async e=>{(await h(a.APPROVED)).success?(i.success("Request approved"),o()):i.error("Failed to approve request")},disabled:e=>e.status===a.APPROVED||e.status===a.CLOSED},{label:"Close",icon:s.jsx(j,{"code-path":"src/admin/pages/RequestsPage.tsx:227:13",className:"w-4 h-4"}),onClick:async e=>{(await h(a.CLOSED)).success?(i.success("Request closed"),o()):i.error("Failed to close request")},disabled:e=>e.status===a.CLOSED},{label:"Delete",icon:s.jsx(_,{"code-path":"src/admin/pages/RequestsPage.tsx:241:13",className:"w-4 h-4"}),onClick:e=>m(e.id),variant:"destructive"}],[o]),T=(e,r)=>{const p={...c,[e]:r};P(p),b(d=>({...d,page:1}));const x=new URLSearchParams;Object.entries(p).forEach(([d,k])=>{k&&x.set(d,k)}),n(x)},C=()=>{P({status:"",search:"",priority:"",request_type:""}),b(e=>({...e,page:1})),n(new URLSearchParams)},A=t?[{key:"requester",label:"Requester",type:"text",value:t.talent?.full_name||t.sponsor?.full_name||"Unknown"},{key:"request_type",label:"Request Type",type:"badge",value:t.request_type.replace("_"," ")},{key:"priority",label:"Priority",type:"badge",value:t.priority||"Normal"},{key:"description",label:"Description",type:"text",value:t.description},{key:"admin_notes",label:"Admin Notes",type:"text",value:t.admin_notes},{key:"created_at",label:"Submitted",type:"date",value:t.created_at},{key:"resolved_at",label:"Resolved",type:"date",value:t.resolved_at}]:[];return s.jsxs(z,{"code-path":"src/admin/pages/RequestsPage.tsx:318:5",title:"Requests",subtitle:"Manage talent and sponsor requests",children:[f&&s.jsxs("div",{"code-path":"src/admin/pages/RequestsPage.tsx:324:9",className:"mb-4 p-4 rounded-lg bg-red-50 text-red-600 text-sm",children:[f,s.jsx(B,{"code-path":"src/admin/pages/RequestsPage.tsx:326:11",variant:"link",onClick:o,className:"ml-2",children:"Retry"})]}),s.jsx(U,{"code-path":"src/admin/pages/RequestsPage.tsx:333:7",filters:te,values:c,onChange:T,onClear:C,className:"mb-6"}),D?s.jsx(W,{"code-path":"src/admin/pages/RequestsPage.tsx:343:9",columns:6,rows:5}):s.jsx(I,{"code-path":"src/admin/pages/RequestsPage.tsx:345:9",data:g.data,columns:O,keyExtractor:e=>e.id,actions:L,pagination:{page:g.page,perPage:g.perPage,total:g.count,onPageChange:e=>b(r=>({...r,page:e}))},onRowClick:e=>R(e.id),emptyState:{title:"No requests found",description:"Try adjusting your filters.",icon:s.jsx(M,{"code-path":"src/admin/pages/RequestsPage.tsx:360:19",className:"w-10 h-10 text-muted-foreground/50"}),action:{label:"Clear Filters",onClick:C}}}),s.jsx(V,{"code-path":"src/admin/pages/RequestsPage.tsx:370:7",isOpen:!!q,onClose:()=>R(null),title:"Request Details",subtitle:t?.request_type.replace("_"," "),status:t?{value:t.status,type:"request"}:void 0,fields:A,actions:{primary:t?.status!==a.APPROVED&&t?.status!==a.CLOSED?{label:"Approve",icon:s.jsx(S,{"code-path":"src/admin/pages/RequestsPage.tsx:380:19",className:"w-4 h-4"}),onClick:async()=>{(await h(a.APPROVED)).success&&(i.success("Request approved"),o())}}:void 0,secondary:[...t?.status!==a.CLOSED?[{label:"Close Request",icon:s.jsx(j,{"code-path":"src/admin/pages/RequestsPage.tsx:392:21",className:"w-4 h-4"}),onClick:async()=>{(await h(a.CLOSED)).success&&(i.success("Request closed"),o())}}]:[],{label:"Delete",icon:s.jsx(_,{"code-path":"src/admin/pages/RequestsPage.tsx:403:21",className:"w-4 h-4"}),onClick:()=>m(q)}]}}),s.jsx(G,{"code-path":"src/admin/pages/RequestsPage.tsx:411:7",isOpen:!!w,onClose:()=>m(null),onConfirm:()=>{m(null),i.success("Request deleted"),o()},title:"Delete Request",description:"Are you sure you want to delete this request? This action cannot be undone.",confirmLabel:"Delete",variant:"danger"})]})}export{Be as default};
